use super::*;

macro_rules! test_u8 {
    ($(($lhs:expr) e>> ($rhs:expr) == $res:expr,)+) => {
        $(
            assert_eq!(
                <u8 as CheckedShrExact>::checked_shr_exact($lhs, $rhs),
                $res.into()
            );
        )+
    };
}

macro_rules! test_i8 {
    ($(($lhs:expr) e>> ($rhs:expr) == $res:expr,)+) => {
        $(
            assert_eq!(
                <i8 as CheckedShrExact>::checked_shr_exact(
                    u8::from($lhs).cast_signed(),
                    $rhs
                ),
                Option::<u8>::from($res).map(|v| v.cast_signed())
            );
        )+
    };
}

#[test]
#[expect(clippy::cognitive_complexity)]
fn u8_test() {
    test_u8!(
        //
        (0b0000_0000) e>> (0) == 0b0000_0000,
        (0b0000_0000) e>> (1) == 0b0000_0000,
        (0b0000_0000) e>> (2) == 0b0000_0000,
        (0b0000_0000) e>> (3) == 0b0000_0000,
        (0b0000_0000) e>> (4) == 0b0000_0000,
        (0b0000_0000) e>> (5) == 0b0000_0000,
        (0b0000_0000) e>> (6) == 0b0000_0000,
        (0b0000_0000) e>> (7) == 0b0000_0000,
        (0b0000_0000) e>> (8) == None,
        //
        (0b0000_0001) e>> (0) == 0b0000_0001,
        (0b0000_0001) e>> (1) == None,
        (0b0000_0001) e>> (2) == None,
        (0b0000_0001) e>> (3) == None,
        (0b0000_0001) e>> (4) == None,
        (0b0000_0001) e>> (5) == None,
        (0b0000_0001) e>> (6) == None,
        (0b0000_0001) e>> (7) == None,
        (0b0000_0001) e>> (8) == None,
        //
        (0b0000_0010) e>> (0) == 0b0000_0010,
        (0b0000_0010) e>> (1) == 0b0000_0001,
        (0b0000_0010) e>> (2) == None,
        (0b0000_0010) e>> (3) == None,
        (0b0000_0010) e>> (4) == None,
        (0b0000_0010) e>> (5) == None,
        (0b0000_0010) e>> (6) == None,
        (0b0000_0010) e>> (7) == None,
        (0b0000_0010) e>> (8) == None,
        //
        (0b0000_0011) e>> (0) == 0b0000_0011,
        (0b0000_0011) e>> (1) == None,
        (0b0000_0011) e>> (2) == None,
        (0b0000_0011) e>> (3) == None,
        (0b0000_0011) e>> (4) == None,
        (0b0000_0011) e>> (5) == None,
        (0b0000_0011) e>> (6) == None,
        (0b0000_0011) e>> (7) == None,
        (0b0000_0011) e>> (8) == None,
        //
        (0b1000_0000) e>> (0) == 0b1000_0000,
        (0b1000_0000) e>> (1) == 0b0100_0000,
        (0b1000_0000) e>> (2) == 0b0010_0000,
        (0b1000_0000) e>> (3) == 0b0001_0000,
        (0b1000_0000) e>> (4) == 0b0000_1000,
        (0b1000_0000) e>> (5) == 0b0000_0100,
        (0b1000_0000) e>> (6) == 0b0000_0010,
        (0b1000_0000) e>> (7) == 0b0000_0001,
        (0b1000_0000) e>> (8) == None,
    );
}

#[test]
#[expect(clippy::cognitive_complexity)]
fn i8_test() {
    test_i8!(
        //
        (0b0000_0000) e>> (0) == 0b0000_0000,
        (0b0000_0000) e>> (1) == 0b0000_0000,
        (0b0000_0000) e>> (2) == 0b0000_0000,
        (0b0000_0000) e>> (3) == 0b0000_0000,
        (0b0000_0000) e>> (4) == 0b0000_0000,
        (0b0000_0000) e>> (5) == 0b0000_0000,
        (0b0000_0000) e>> (6) == 0b0000_0000,
        (0b0000_0000) e>> (7) == 0b0000_0000,
        (0b0000_0000) e>> (8) == None,
        //
        (0b0000_0001) e>> (0) == 0b0000_0001,
        (0b0000_0001) e>> (1) == None,
        (0b0000_0001) e>> (2) == None,
        (0b0000_0001) e>> (3) == None,
        (0b0000_0001) e>> (4) == None,
        (0b0000_0001) e>> (5) == None,
        (0b0000_0001) e>> (6) == None,
        (0b0000_0001) e>> (7) == None,
        (0b0000_0001) e>> (8) == None,
        //
        (0b0000_0010) e>> (0) == 0b0000_0010,
        (0b0000_0010) e>> (1) == 0b0000_0001,
        (0b0000_0010) e>> (2) == None,
        (0b0000_0010) e>> (3) == None,
        (0b0000_0010) e>> (4) == None,
        (0b0000_0010) e>> (5) == None,
        (0b0000_0010) e>> (6) == None,
        (0b0000_0010) e>> (7) == None,
        (0b0000_0010) e>> (8) == None,
        //
        (0b0000_0011) e>> (0) == 0b0000_0011,
        (0b0000_0011) e>> (1) == None,
        (0b0000_0011) e>> (2) == None,
        (0b0000_0011) e>> (3) == None,
        (0b0000_0011) e>> (4) == None,
        (0b0000_0011) e>> (5) == None,
        (0b0000_0011) e>> (6) == None,
        (0b0000_0011) e>> (7) == None,
        (0b0000_0011) e>> (8) == None,
        //-----------------------------------
        (0b1000_0000) e>> (0) == 0b1000_0000,
        (0b1000_0000) e>> (1) == 0b1100_0000,
        (0b1000_0000) e>> (2) == 0b1110_0000,
        (0b1000_0000) e>> (3) == 0b1111_0000,
        (0b1000_0000) e>> (4) == 0b1111_1000,
        (0b1000_0000) e>> (5) == 0b1111_1100,
        (0b1000_0000) e>> (6) == 0b1111_1110,
        (0b1000_0000) e>> (7) == 0b1111_1111,
        (0b1000_0000) e>> (8) == None,
        //
        (0b1000_0001) e>> (0) == 0b1000_0001,
        (0b1000_0001) e>> (1) == None,
        (0b1000_0001) e>> (2) == None,
        (0b1000_0001) e>> (3) == None,
        (0b1000_0001) e>> (4) == None,
        (0b1000_0001) e>> (5) == None,
        (0b1000_0001) e>> (6) == None,
        (0b1000_0001) e>> (7) == None,
        (0b1000_0001) e>> (8) == None,
        //
        (0b1000_0010) e>> (0) == 0b1000_0010,
        (0b1000_0010) e>> (1) == 0b1100_0001,
        (0b1000_0010) e>> (2) == None,
        (0b1000_0010) e>> (3) == None,
        (0b1000_0010) e>> (4) == None,
        (0b1000_0010) e>> (5) == None,
        (0b1000_0010) e>> (6) == None,
        (0b1000_0010) e>> (7) == None,
        (0b1000_0010) e>> (8) == None,
        //
        (0b1000_0011) e>> (0) == 0b1000_0011,
        (0b1000_0011) e>> (1) == None,
        (0b1000_0011) e>> (2) == None,
        (0b1000_0011) e>> (3) == None,
        (0b1000_0011) e>> (4) == None,
        (0b1000_0011) e>> (5) == None,
        (0b1000_0011) e>> (6) == None,
        (0b1000_0011) e>> (7) == None,
        (0b1000_0011) e>> (8) == None,
    );
}
